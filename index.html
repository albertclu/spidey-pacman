<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Spidey-Maze Classic</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
    <style>
        body { margin: 0; background-color: #000; display: flex; justify-content: center; align-items: center; height: 100vh; font-family: 'Courier New', Courier, monospace; }
        #game-container { position: relative; border: 2px solid #e23636; }
        .ui-screen {
            position: absolute; width: 100%; height: 100%; background: rgba(0,0,0,0.85);
            display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; text-align: center; z-index: 10;
        }
        button { padding: 15px 30px; font-size: 20px; background: #e23636; color: white; border: none; cursor: pointer; border-radius: 5px; font-weight: bold; }
        .hidden { display: none; }
        #ui-layer { position: absolute; top: 10px; width: 100%; display: flex; justify-content: space-around; color: white; font-size: 20px; pointer-events: none; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="ui-layer">
        <div id="score">Score: 0</div>
        <div id="high-score">High: 0</div>
    </div>

    <div id="start-screen" class="ui-screen">
        <h1 style="color: #e23636;">SPIDEY-MAZE</h1>
        <p>Avoid the villains! Collect all the webs!</p>
        <button onclick="startGame()">PLAY GAME</button>
    </div>

    <div id="game-over-screen" class="ui-screen hidden">
        <h1 style="color: #e23636;">CAUGHT!</h1>
        <button onclick="location.reload()">TRY AGAIN</button>
    </div>
</div>

<script>
let score = 0;
let highScore = localStorage.getItem('spideyHighScore') || 0;

const config = {
    type: Phaser.AUTO,
    width: 800, 
    height: 600,
    parent: 'game-container',
    physics: { 
        default: 'arcade', 
        arcade: { 
            gravity: { y: 0 },
            debug: false // Set to true if you want to see the "hitboxes"
        } 
    },
    scene: { preload: preload, create: create, update: update }
};

const mazeLayout = [
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    [1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1],
    [1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,0,1],
    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
    [1,0,1,1,0,1,0,1,1,1,1,1,0,1,0,1,1,0,1],
    [1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1],
    [1,1,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,1,1],
    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
    [1,1,1,1,0,1,0,1,1,0,1,1,0,1,0,1,1,1,1],
    [0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0],
    [1,1,1,1,0,1,0,1,1,1,1,1,0,1,0,1,1,1,1],
    [1,1,1,1,0,1,0,0,0,0,0,0,0,1,0,1,1,1,1],
    [1,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,1],
    [1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,0,1],
    [1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1],
    [1,1,0,1,0,1,0,1,1,1,1,1,0,1,0,1,0,1,1],
    [1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1],
    [1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1],
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
];

function preload() {
    // --- IMPORTANT: Ensure these names match your GitHub files exactly! ---
    // If your folder is named "assets", these paths are correct.
    this.load.image('spiderman', 'assets/spiderman.png');
    this.load.image('kingpin', 'assets/kingpin.png');
    this.load.image('goblin', 'assets/goblin.png');
    this.load.image('doc-ock', 'assets/doc-ock.png');
    this.load.image('venom', 'assets/venom.png');
    this.load.image('wall', 'assets/wall.png'); 
    this.load.image('web', 'assets/web.png'); 
}

function create() {
    this.physics.pause();
    
    this.walls = this.physics.add.staticGroup();
    this.webs = this.physics.add.group();

    // WIDER GRID: We use 60px instead of 40px
    const tileSize = 60;

    mazeLayout.forEach((row, y) => {
        row.forEach((cell, x) => {
            let posX = x * tileSize + tileSize/2;
            let posY = y * tileSize + tileSize/2;

            if (cell === 1) {
                // Wall is 60x60
                this.walls.create(posX, posY, 'wall').setDisplaySize(tileSize, tileSize).refreshBody();
            } else {
                // Web is small (15x15) so it's easy to pick up
                this.webs.create(posX, posY, 'web').setDisplaySize(20, 20);
            }
        });
    });
    
// SPIDEY: We make him 30px so he has 30px of "extra space" in the 60px path
    this.player = this.physics.add.sprite(90, 90, 'spiderman').setDisplaySize(35, 35);
    this.player.setCollideWorldBounds(true);
    // This makes the "hitbox" a bit smaller so he doesn't clip corners
    this.player.body.setSize(25, 25);

    this.villains = this.physics.add.group();
    let villainsList = ['kingpin', 'goblin', 'doc-ock', 'venom'];
    villainsList.forEach((key, index) => {
        let v = this.villains.create(300, 300, key).setDisplaySize(35, 35);
        v.setBounce(1).setCollideWorldBounds(true);
        v.body.setSize(25, 25); // Smaller hitboxes prevent getting stuck
        v.setVelocity(Phaser.Math.Between(-100, 100), Phaser.Math.Between(-100, 100));
    });

    this.physics.add.collider(this.player, this.walls);
    this.physics.add.collider(this.villains, this.walls);
    this.physics.add.overlap(this.player, this.webs, collectWeb, null, this);
    this.physics.add.overlap(this.player, this.villains, handleGameOver, null, this);
}
    
function update() {
    let cursors = this.input.keyboard.createCursorKeys();
    this.player.setVelocity(0);
    if (cursors.left.isDown) this.player.setVelocityX(-180);
    else if (cursors.right.isDown) this.player.setVelocityX(180);
    if (cursors.up.isDown) this.player.setVelocityY(-180);
    else if (cursors.down.isDown) this.player.setVelocityY(180);
}

function collectWeb(player, web) {
    web.disableBody(true, true);
    score += 10;
    document.getElementById('score').innerText = "Score: " + score;
    if (score > highScore) {
        highScore = score;
        document.getElementById('high-score').innerText = "High: " + highScore;
        localStorage.setItem('spideyHighScore', highScore);
    }
}

function handleGameOver() {
    this.physics.pause();
    document.getElementById('game-over-screen').classList.remove('hidden');
}

function startGame() {
    document.getElementById('start-screen').classList.add('hidden');
    game.scene.scenes[0].physics.resume();
}

const game = new Phaser.Game(config);
</script>
</body>
</html>

