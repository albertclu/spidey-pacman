<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spidey vs The Sinister Four</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
    <style>
        body { margin: 0; background-color: #000; display: flex; justify-content: center; align-items: center; height: 100vh; }
        canvas { border: 2px solid #e23636; } /* Spidey Red Border */
    </style>
</head>
<body>

<script>
// --- YOUR GAME CODE STARTS HERE ---
const config = {
    type: Phaser.AUTO,
    width: 608, // Adjusted to fit 19 columns of 32px
    height: 640, // Adjusted to fit 20 rows of 32px
    physics: {
        default: 'arcade',
        arcade: { gravity: { y: 0 } }
    },
    scene: { preload: preload, create: create, update: update }
};

// 1 = Wall, 0 = Path (for Spidey and Villains)
const mazeLayout = [
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    [1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1],
    [1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,0,1],
    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
    [1,0,1,1,0,1,0,1,1,1,1,1,0,1,0,1,1,0,1],
    [1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1],
    [1,1,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,1,1],
    [1,1,1,1,0,1,0,0,0,0,0,0,0,1,0,1,1,1,1],
    [1,1,1,1,0,1,0,1,1,0,1,1,0,1,0,1,1,1,1],
    [0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0], // Side Tunnel
    [1,1,1,1,0,1,0,1,1,1,1,1,0,1,0,1,1,1,1],
    [1,1,1,1,0,1,0,0,0,0,0,0,0,1,0,1,1,1,1],
    [1,1,1,1,0,1,0,1,1,1,1,1,0,1,0,1,1,1,1],
    [1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1],
    [1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,0,1],
    [1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1],
    [1,1,0,1,0,1,0,1,1,1,1,1,0,1,0,1,0,1,1],
    [1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1],
    [1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1],
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
];

function preload() {
    this.load.image('spiderman', 'assets/spiderman.png');
    this.load.image('kingpin', 'assets/kingpin.png');
    this.load.image('goblin', 'assets/goblin.png');
    this.load.image('doc-ock', 'assets/doc-ock.png');
    this.load.image('venom', 'assets/venom.png');
    this.load.image('wall', 'assets/wall.png'); 
}

function create() {
    this.walls = this.physics.add.staticGroup();

    // Loop through the array to draw the maze
    mazeLayout.forEach((row, y) => {
        row.forEach((cell, x) => {
            if (cell === 1) {
                // 32 is the size of the wall image
                this.walls.create(x * 32 + 16, y * 32 + 16, 'wall');
            }
        });
    });

    // Spawn Spiderman in a safe spot (row 1, col 1)
    this.player = this.physics.add.sprite(48, 48, 'spiderman');
    this.player.setCollideWorldBounds(true);

    // Spawn Villains in the middle
    this.villains = this.physics.add.group();
    let villainsList = ['kingpin', 'goblin', 'doc-ock', 'venom'];
    villainsList.forEach((key, index) => {
        let v = this.villains.create(304, 288, key);
        v.setBounce(1);
        v.setVelocity(Phaser.Math.Between(-100, 100), Phaser.Math.Between(-100, 100));
    });

    // Add Colliders
    this.physics.add.collider(this.player, this.walls);
    this.physics.add.collider(this.villains, this.walls);
    this.physics.add.overlap(this.player, this.villains, gameOver, null, this);
}

function update() {
    let cursors = this.input.keyboard.createCursorKeys();
    this.player.setVelocity(0);

    if (cursors.left.isDown) this.player.setVelocityX(-160);
    else if (cursors.right.isDown) this.player.setVelocityX(160);
    if (cursors.up.isDown) this.player.setVelocityY(-160);
    else if (cursors.down.isDown) this.player.setVelocityY(160);
}

function gameOver() {
    this.physics.pause();
    alert("Captured by the Sinister Four!");
    location.reload();
}

const game = new Phaser.Game(config);
// --- YOUR GAME CODE ENDS HERE ---
</script>

</body>
</html>

